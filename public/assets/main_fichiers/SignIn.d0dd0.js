(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{Q1cm:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{class:t.mainClass},[e("ExternalLoginsComponent",{attrs:{setParentServerSideError:t.setServerSideError}}),t._v(" "),e("div",{staticClass:"or-content"},[e("span",[t._v(t._s(t.$t("conditions.or")))])]),t._v(" "),e("i-form",{ref:"form",attrs:{autocomplete:"off",validateOnSubmit:""}},[e("div",{staticClass:"control-wrapper"},[t.hasServerSideError?e("i-alert",{attrs:{type:"error"}},[t._v("\n\t\t\t\t"+t._s(t.errorMessage)+"\n\t\t\t")]):t._e(),t._v(" "),e("label",[t._v(t._s(t.$t("auth.usernameOrEmail")))]),t._v(" "),e("i-text",{ref:"usernameInput",attrs:{placeholder:t.$t("auth.exampleEmail"),autocapitalize:"none",type:"text",rules:t.validationRoles.usernameAndEmailRolesForLogin,required:"",name:"username",autocomplete:"username"},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit.apply(null,arguments)},t.keyupEvent]},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),t._v(" "),e("div",{staticClass:"control-wrapper"},[e("label",[t._v(t._s(t.$t("password")))]),t._v(" "),e("i-text",{ref:"passwordInput",staticClass:"sign-password-input",attrs:{placeholder:t.$t("auth.yourPassword"),rules:t.validationRoles.passwordRoles,type:t.showPassword?"text":"password",required:"",name:"password",appendIcon:t.passwordAppendIcon,autocomplete:"current-password"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit.apply(null,arguments)},clickAppendIcon:t.clickAppendIcon},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),t._v(" "),e("div",{staticClass:"forgot-wrapper"},[e("router-link",{staticClass:"forgot-password",attrs:{to:t.forgotPasswordRoute,tabindex:"1"}},[t._v(t._s(t.$t("auth.forgotPassword")))])],1),t._v(" "),e("div",{staticClass:"text-center captcha"},[e("div",{staticClass:"control-wrapper"},[e("Captcha",{key:t.captchaVersion,ref:"captcha",attrs:{version:t.captchaVersion},model:{value:t.captchaOptions,callback:function(e){t.captchaOptions=e},expression:"captchaOptions"}})],1)]),t._v(" "),e("div",{staticClass:"auth-button-wrapper text-center"},[e("i-button",{staticClass:"auth-button",class:{"loading-btn":t.submitButtonLoading},attrs:{tabindex:"0",loading:t.submitButtonLoading},on:{click:t.onSubmit}},[t._v(t._s(t.$t("login")))])],1)],1)]),t._v(" "),e("div",{staticClass:"auth-button-bottom"},[e("p",[t._v(t._s(t.$t("auth.dontHaveAccount")))]),t._v(" "),e("router-link",{staticClass:"sign-up",attrs:{tabindex:"1",to:t.signUpRoute}},[t._v(t._s(t.$t("auth.signUp")))])],1)],1)};s._withStripped=!0;var a,o,i=r("yXPU"),n=r.n(i),c=r("ajPk"),u=r("0d3v"),p=r("ttAG"),d=r("4da+"),h=r("luLf"),l=r("/BYU"),m=r("pjF1"),v=r("sjWk"),f=r("oQAm"),w={name:"SignIn",components:{ExternalLoginsComponent:c.a,Captcha:m.a},props:["mainClass"],data:function(){return{submitButtonLoading:!1,hasServerSideError:!1,errorMessage:"",externalLoginProviders:[],valid:!0,username:"",password:"",validationRoles:Object(d.a)(),passwordAppendIcon:"eye",showPassword:!1,signUpRoute:{name:"SignUp",query:{redirect:this.$route.query.redirect,token:this.$route.query.token,provider:this.$route.query.provider},hash:"#withemail"},forgotPasswordRoute:{name:"ForgotPassword",query:{redirect:this.$route.query.redirect,provider:this.$route.query.provider}},captchaVersion:3,captchaOptions:{}}},mounted:function(){var t=Math.floor(4*Math.random())+1;this.$emit("setTitle","auth.signText"+t),p.default.isEmpty(this.$route.params.hasServerSideError)||(this.hasServerSideError=this.$route.params.hasServerSideError),p.default.isEmpty(this.$route.params.errorMessage)||(this.errorMessage=this.$route.params.errorMessage),p.default.isEmpty(this.$route.params.email)||(this.username=this.$route.params.email),this.$auth.isAuthenticated()&&(this.submitButtonLoading=!0,l.a.setAuthTokenCookie(),p.default.redirectToLocalUrl(this.$route.query.redirect,this.$router))},methods:{onSubmit:(o=n()((function*(){this.submitButtonLoading=!0;var t=!1;if(this.$refs.form.validate()){if(3===this.captchaVersion&&!this.captchaOptions.isOk&&this.username){var e=Object(f.a)(this.username.split("@")[0]);this.captchaOptions=yield this.$refs.captcha.getToken(!0,"".concat(e,"_sign_in"))}if(!0===this.captchaOptions.isOk){this.hasServerSideError=!1;var r=yield u.a.login({username:this.username,password:this.password,captcha:this.captchaOptions});if(r.success)"activeElement"in document&&document.activeElement.blur(),v.a.emailLogin(r.access_token),this.$auth.setToken(r),l.a.onAfterSuccessLogin(this,p.default,"email"),t=!0;else{this.hasServerSideError=!0;var s=" ".concat(this.$root.$t("notification.traceCode"),": SING0001"),a=this.$root.$t("notification.anErrorOccurred",{moreDetail:s});r.errors&&(r.errors.captchaIsRequired&&(this.captchaVersion=2,a=this.$t("notARobot")),r.errors.errorCode&&(a=Object(h.a)("auth."+r.errors.errorCode))),this.$refs.captcha&&this.$refs.captcha.reset(),this.errorMessage=a}}else this.captchaVersion=2,this.$refs.captcha&&this.$refs.captcha.reset()}this.submitButtonLoading=t})),function(){return o.apply(this,arguments)}),keyupEvent:function(){this.hasServerSideError&&(this.$refs.form.validate(),this.hasServerSideError=!1)},setServerSideError:function(t,e,r){this.hasServerSideError=t,this.errorMessage=e,this.username=r},clickAppendIcon:(a=n()((function*(){this.showPassword=!this.showPassword,this.showPassword?this.passwordAppendIcon="eye-slash":this.passwordAppendIcon="eye"})),function(){return a.apply(this,arguments)})}},g=r("KHd+"),y=Object(g.a)(w,s,[],!1,null,null,null);e.default=y.exports}}]);